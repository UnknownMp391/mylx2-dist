import{A as g,r as _,G as k,o as y,z as $,H as w,g as s,h as a,F as I,C as x,u as n,i as l,B as S,D as E,j as T,x as C}from"./vendor-DHGCqLyH.js";import{u as H,b as R,e as v,m as B}from"./index-BvAo4jYu.js";import{b as L,u as b}from"./homePage-BLQsmEBP.js";import{_ as A}from"./AccountBar-3FUT1BDo.js";const N={key:0},M=["onClick"],P=["onClick"],V=["innerHTML"],D={key:1,style:{margin:"10px"}},Y={__name:"Recommend",setup(F){const d=g(),u=L(),r=b(),c=H(),i=r.recommends,m=_(!!i);async function p(){const o=await c.getRecommend(null,r.lastRecommend);r.lastRecommend=o.last,r.moreRecommend=o.more,o.code==1&&o.status==1?o.recommends.forEach(t=>{t.authorInfo.avatar?t.avatar=`${c.config.ossEndpoint}/${t.authorInfo.avatar}`:t.avatar=`${c.config.ossEndpoint}/${c.config.defaultAvatarID}`,i.push(t)}):B("错误",`${o.code} ${o.status}`),m.value=!0}const f=k(()=>{const o=document.documentElement.scrollTop||document.body.scrollTop,t=document.documentElement.scrollHeight,e=document.documentElement.clientHeight;Math.abs(o+e-t)<10&&(R("滑动到底部了"),p())},500);return y(async()=>{$(async()=>{window.scrollTo(0,u.getPosition("recommend")),await p(),m.value=!0}),window.addEventListener("scroll",f)}),w(()=>{window.removeEventListener("scroll",f),u.savePosition("recommend",window.scrollY)}),(o,t)=>m.value?(s(),a("div",N,[(s(!0),a(I,null,x(n(i),e=>(s(),a("mdui-card",{key:e.postId},[e.title?(s(),a("div",{key:0,style:{"font-size":"2em",margin:"10px"},onClick:h=>n(d).push(`/post?postId=${e.postId}`)},[l("strong",null,S(e.title),1)],8,M)):E("",!0),T(A,{avatarUrl:e.avatar,name:n(v)(e.authorInfo.nickName),onClick:h=>n(d).push(`/user?userId=${e.authorInfo.userId}`)},null,8,["avatarUrl","name","onClick"]),l("div",{style:{"text-indent":"0em",margin:"10px"},onClick:h=>n(d).push(`/post?postId=${e.postId}`)},[l("div",{style:{"white-space":"pre-wrap"},innerHTML:n(v)(e.content)},null,8,V)],8,P)]))),128))])):(s(),a("div",D,t[0]||(t[0]=[C(" 加载中 "),l("mdui-linear-progress",null,null,-1)])))}};export{Y as default};
