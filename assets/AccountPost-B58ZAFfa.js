import{r as a,G as k,o as y,z as g,H as w,h as n,F as x,C,g as l,u as r,i as s,B as E,D as T,t as $,A as b,E as H}from"./vendor-DHGCqLyH.js";import{u as A,e as I,m as B,b as L}from"./index-BvAo4jYu.js";const M=["onClick"],P=["onClick"],S=["innerHTML"],D={class:"toolbar"},F=["onClick"],V={__name:"AccountPost",setup(O){const i=b(),u=A(),c=a([]),d=a(0),v=a(!1);async function p(){const t=await u.getAccountPost(null,d.value);t.code==1&&t.status==1?(d.value=t.last,v.value=t.more,t.posts.forEach(o=>{c.value.push(o)})):B("错误",`${t.code} ${t.status}`)}function h(t,o){H({headline:"警告!",description:`你确定要删除 ${o.title} 吗?`,confirmText:"删掉",cancelText:"算了",closeOnOverlayClick:!0,closeOnEsc:!0,onConfirm:async()=>{const e=await u.deletePost(o.postId);e.code==1&&e.status==1&&(L("删除成功"),c.value.splice(t,1))}})}const m=k(()=>{const t=document.documentElement.scrollTop||document.body.scrollTop,o=document.documentElement.scrollHeight,e=document.documentElement.clientHeight;Math.abs(t+e-o)<1&&p()},500);return y(async()=>{g(async()=>{await p()}),window.addEventListener("scroll",m)}),w(()=>{window.removeEventListener("scroll",m)}),(t,o)=>(l(),n("div",null,[(l(!0),n(x,null,C(c.value,(e,_)=>(l(),n("mdui-card",{key:e.postId},[e.title?(l(),n("div",{key:0,style:{"font-size":"1.3em",margin:"0px 10px"},onClick:f=>r(i).push(`/post?postId=${e.postId}`)},[s("strong",null,E(e.title),1)],8,M)):T("",!0),s("div",{style:{"text-indent":"0em",margin:"10px"},onClick:f=>r(i).push(`/post?postId=${e.postId}`)},[s("div",{style:{"white-space":"pre-wrap"},innerHTML:r(I)(e.content)},null,8,S)],8,P),s("div",D,[o[0]||(o[0]=s("mdui-button",{class:"toolitem"},"编辑",-1)),o[1]||(o[1]=s("div",{style:{flex:"1"}},null,-1)),s("mdui-button",{class:"toolitem warn",onClick:$(f=>h(_,e),["prevent"])},"删除",8,F)])]))),128))]))}};export{V as default};
